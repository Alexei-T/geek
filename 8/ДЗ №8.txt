ЗАДАНИЕ:
1)Настроить сетевой фильтр, чтобы из внешней сети можно было обратиться только к сервисам http и ssh (80 и 22).
2)Запросы, идущие на порт 8080, перенаправлять на порт 80.
3)Настроить доступ по ssh только для вашего IP-адреса (или из всей сети вашего провайдера).
4.* Создать нового пользователя, сгенерировать для него новые сертификаты. Настроить доступ на сервер вновь созданного пользователя с использованием сертификатов.
Подключиться с помощью putty или ssh без ввода пароля (используя только сертификат).
Примечание: сертификат может быть подготовлен как в Ubuntu, так и с помощью puttygen в windows.
5.* Ваши коллеги, студенты, настраивали VDS-сервер для использования на командном проекте. Через некоторое время сервер был заблокирован. Студенты связались с хостером,
он предоставил abuse-письмо (настоящий IP-адрес машины студентов был заменен на 203.0.113.198)
В качестве тренажера вам будет предложен образ машины: один чистый, второй зараженный. Образ зараженной машины — тренажер, он содержит деактивированное ПО,
лишенное настоящей активности, но в него добавлены компоненты, имитирующие ее. IP-адрес с белого (в письме он обозначен как 203.0.113.198) заменен на адрес в 10.0.0.0/8
или 192.168.0.0/24 сети.
Вам необходимо создать виртуальную машину и прикрепить виртуальный жесткий диск с, возможно, зараженной ОС.
В качестве практического задания вы сдаете файл doc / pdf / google doc, в котором описываете, какими командами и что вы проверяли, какие активности были обнаружены
и что вы предприняли и рекомендуете сделать, чтобы через некоторое время машину не заблокировали снова.
Ссылка на образ жесткого диска (использовалась версия Virtual Box 6.0): ****

РЕШЕНИЕ:
1)
#Установим на Centos iptables, внешний интерфейс "eth1"
dnf install iptables-services -y
systemctl enable --now iptables
iptables -A INPUT -i eth1 -p TCP --dport 22 -j ACCEPT
iptables -A INPUT -i eth1 -p TCP --dport 80 -j ACCEPT
iptables -A INPUT -i eth1 -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -i eth1 -j DROP
iptables-save | tee /etc/sysconfig/iptables    #Посмотреть текущие настройки и сохранить перманентно
2)
iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 8080 -j REDIRECT --to-port 80
iptables-save | tee /etc/sysconfig/iptables
3)
#Разрешим подключения только с ip 10.0.10.1
iptables -I INPUT 1 -i eth1 -p tcp --dport 22 -s 10.0.10.1 -j ACCEPT
#Найдем старое правило для ssh и удалим
iptables -L INPUT --line-numbers | grep ssh
iptables -D INPUT "номер строки"
iptables-save | tee /etc/sysconfig/iptables
4.*
#С машины откуда будет подключение:
ssh-keygen                           #генерируем ключи
ssh-copy-id alex@10.0.10.37          #публичный ключ будет скопирован на машину 10.0.10.37 для юзера "alex"
#После проверки можем отключить аутентификацию по паролю:
vim /etc/ssh/sshd_config
PasswordAuthentication no    

